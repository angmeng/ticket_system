<% if @order.buyer_is_agent? && @net_total > @order.buyer_credit %>
	<div class="alert">
	  <button type="button" class="close" data-dismiss="alert">×</button>
	  <h4>Warning!</h4>
	   Agent credit is not enough !

		<!-- Button to trigger modal -->
		<a href="#byPass" role="button" class="btn btn-primary" data-toggle="modal">Bypass</a>

	</div>
<% end %>

<dl class="dl-horizontal">
  <dt><%= @order.buyer_title %></dt><dd><%= @order.buyer_name %></dd>
  <dt>Current Credit</dt><dd><%= @order.buyer_credit %></dd>
</dl>
 
<!-- Modal -->
<div id="byPass" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Authorize</h3>
  </div>
  <div class="modal-body">
	<p><%= text_field_tag :username, params[:username], :placeholder => "Username" %></p>
	<p><%= password_field_tag :password, params[:password], :placeholder => "Password" %></p>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
    <a href="#" class="btn btn-primary" id="ok_button">OK</a>
  </div>
</div>

<% content_for :javascripts_path do %>
      <script>
       $(function(){

          $("#ok_button").click(function(){
            // <% if @order.buyer_is_agent? && @net_total > @order.buyer_credit %>

            	var username = $("#username").val();
            	var password = $("#password").val();

            	alert(username);
            	alert(password);


            	$.ajax({
    		  			type:'POST', 
    		  			dataType:"json",
    		  			url: '/orders/user_authorize', 
    		  			data: { 'username' : username, 'password' : password },
    		  			success: function(response) {
                        // var obj = $.parseJSON(response);
                      	if( response.status == true ) {
                      		alert ("testing 1");
                        } else {
                          alert("testing 2");
          							}				
					    }
					});
				});

            	// return false;

            // <% end %>
          });


       	    });
       </script>

    <% end %>


